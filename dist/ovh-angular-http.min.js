/*! ovh-angular-http - 3.0.0 - 2017-08-21 */
angular.module("ovh-angular-http",[]),angular.module("ovh-angular-http").provider("OvhHttp",function(){"use strict";var a=this;a.rootPath="",a.clearCacheVerb=[],a.returnSuccessKey=null,a.returnErrorKey=null,a.$get=["$http","$q","$rootScope","$cacheFactory",function(b,c,d,e){function f(f){f.encodeParams===!0&&angular.forEach(f.params,function(b,c){f.params[c]=a.encode(b)}),f.encodeUrlParams===!0&&angular.forEach(f.urlParams,function(b,c){f.urlParams[c]=a.encode(b)});var h=URI.expand(f.url,f.urlParams||{}).search(f.params||{}).toString(),i=f.data?angular.toJson(f.data):{};if(angular.isDefined(f.cache)&&(!angular.isString(f.cache)||""===f.cache))throw"cache must be string (not empty)";if(angular.isDefined(f.cacheTTL)&&!angular.isNumber(f.cacheTTL))throw"cacheTTL must be number (milliseconds)";if(angular.isDefined(f.clearAllCache)&&!(angular.isString(f.clearAllCache)&&""!==f.clearAllCache||angular.isArray(f.clearAllCache)||f.clearAllCache===!0||f.clearAllCache===!1))throw"clearAllCache must be array of string (not empty), string or boolean";if(angular.isDefined(f.clearCache)&&!(angular.isString(f.clearCache)&&""!==f.clearCache||angular.isArray(f.clearCache)||f.clearCache===!0||f.clearCache===!1))throw"clearCache must be array of string (not empty), string or boolean";if(f.cache&&angular.isUndefined(g.cache[f.cache])&&(g.cache[f.cache]=e(f.cache),g.cacheTTL[f.cache]={}),angular.isDefined(f.clearAllCache)&&null!==f.clearAllCache&&f.clearAllCache!==!1&&(f.clearAllCache===!0&&angular.isDefined(f.cache)?(g.cache[f.cache].removeAll(),g.cacheTTL[f.cache]={}):angular.isArray(f.clearAllCache)?angular.forEach(f.clearAllCache,function(a){if(angular.isDefined(a)&&(!angular.isString(a)||""===a))throw"clearAllCache must be array of string (not empty), string or boolean";g.cache[a]&&(g.cache[a].removeAll(),g.cacheTTL[a]={})}):g.cache[f.clearAllCache]&&(g.cache[f.clearAllCache].removeAll(),g.cacheTTL[f.clearAllCache]={})),angular.isDefined(f.clearCache)&&null!==f.clearCache&&f.clearCache!==!1&&(f.clearCache===!0&&angular.isDefined(f.cache)?(g.cache[f.cache].remove(h),delete g.cacheTTL[f.cache][h]):angular.isArray(f.clearCache)?angular.forEach(f.clearCache,function(a){if(angular.isDefined(a)&&(!angular.isString(a)||""===a))throw"clearCache must be array of string (not empty), string or boolean";g.cache[a]&&(g.cache[a].remove(h),delete g.cacheTTL[a][h])}):g.cache[f.clearCache]&&(g.cache[f.clearCache].remove(h),delete g.cacheTTL[f.clearCache][h])),f.cache&&-1!==_.indexOf(angular.isDefined(f.clearCacheVerb)&&null!==f.clearCacheVerb?f.clearCacheVerb:a.clearCacheVerb,angular.uppercase(f.method))&&(g.cache[f.cache].remove(h),delete g.cacheTTL[f.clearCache][h]),f.cache&&f.cacheTTL&&"get"===f.method.toLowerCase()){var j=Date.now();g.cacheTTL[f.cache]&&g.cacheTTL[f.cache][h]?g.cacheTTL[f.cache][h]<j&&(g.cache[f.cache].remove(h),g.cacheTTL[f.cache][h]=j+f.cacheTTL):g.cacheTTL[f.cache][h]=j+f.cacheTTL}return b({method:f.method,url:h,data:i,serviceType:f.serviceType,timeout:f.timeout,headers:f.headers,cache:"get"===f.method.toLowerCase()&&g.cache[f.cache]?g.cache[f.cache]:!1}).then(function(a){return f.broadcast&&(f.broadcastParam?d.$broadcast(f.broadcast,f.broadcastParam,a):d.$broadcast(f.broadcast,a)),angular.isString(f.returnSuccessKey)&&""!==f.returnSuccessKey?a[f.returnSuccessKey]:a},function(a){return c.reject(angular.isString(f.returnErrorKey)&&""!==f.returnErrorKey?a[f.returnErrorKey]:a)})}var g={};return g.cache={},g.cacheTTL={},g.schema=function(d,e){return b.get(angular.isObject(e)&&angular.isDefined(e.rootPath)&&null!==e.rootPath?e.rootPath:a.rootPath+d,{cache:!0}).then(function(a){return a.data},function(a){return c.reject(a)})},g.models=function(a,b,d){return g.schema(a,d).then(function(a){return b?a.models[b]?a.models[b]["enum"]:c.reject(a.models):a.models})},g.encode=function(a){return window.encodeURIComponent(a)},angular.forEach(["get","put","post","delete","patch"],function(b){g[b]=function(c,d){var e=d;if(angular.isObject(e)||(e={}),e.method=angular.uppercase(b),e.url=(angular.isDefined(e.rootPath)&&null!==e.rootPath?e.rootPath:a.rootPath)+c,angular.isDefined(e.returnSuccessKey)){if(!angular.isString(e.returnSuccessKey))throw"returnSuccessKey must be string"}else e.returnSuccessKey=a.returnSuccessKey;if(angular.isDefined(e.returnErrorKey)){if(!angular.isString(e.returnErrorKey))throw"returnErrorKey must be string"}else e.returnErrorKey=a.returnErrorKey;return f(e)}}),g}]});